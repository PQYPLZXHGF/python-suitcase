<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started &mdash; suitcase 0.6 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="suitcase 0.6 documentation" href="index.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Suitcase" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Suitcase may be installed directly from <a class="reference external" href="https://pypi.python.org/pypi/suitcase">PyPi</a> using <a class="reference external" href="https://pip.pypa.io/en/stable/">pip</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install suitcase
</pre></div>
</div>
<p>This will install the library as well as any libraries dependended on
by suitcase.</p>
<p>The library is tested to work on the following python versions:</p>
<ul class="simple">
<li>Python 2.7</li>
<li>Python 3.2</li>
<li>Python 3.3</li>
<li>Python 3.4</li>
</ul>
</div>
<div class="section" id="data-modeling">
<h2>Data Modeling<a class="headerlink" href="#data-modeling" title="Permalink to this headline">¶</a></h2>
<p>Suitcase provides a declarative syntax for recording the structure of
the messages in your problem domain.  The first step is to understand
those messages and convert each message layer into its correspdonding
:class:<a href="#id1"><span class="problematic" id="id2">`</span></a>suitcase.structure.Structure`s and
:class:<a href="#id3"><span class="problematic" id="id4">`</span></a>suitcase.fields.Field`s.</p>
<p>Typically, you will end up with one structure for each layer of a
protocol stack, if that is your domain.  For instance, let&#8217;s say that
we wanted to parser and/or pack <a class="reference external" href="https://en.wikipedia.org/wiki/Domain_Name_System#DNS_message_format">DNS messsages</a>.</p>
<p>With just a little reading, we see that each DNS request and response
has a common form which can be declared in suitcase with the following
structure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">from</span> <span class="nn">suitcase.fields</span> <span class="kn">import</span> <span class="n">Payload</span>
<span class="kn">from</span> <span class="nn">suitcase.fields</span> <span class="kn">import</span> <span class="n">UBInt16</span>
<span class="kn">from</span> <span class="nn">suitcase.fields</span> <span class="kn">import</span> <span class="n">BitNum</span>
<span class="kn">from</span> <span class="nn">suitcase.fields</span> <span class="kn">import</span> <span class="n">BitBool</span>
<span class="kn">from</span> <span class="nn">suitcase.fields</span> <span class="kn">import</span> <span class="n">BitField</span>
<span class="kn">from</span> <span class="nn">suitcase.structure</span> <span class="kn">import</span> <span class="n">Structure</span>

<span class="k">class</span> <span class="nc">DNSMessage</span><span class="p">(</span><span class="n">Structure</span><span class="p">):</span>
    <span class="n">identification</span> <span class="o">=</span> <span class="n">UBInt16</span><span class="p">()</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">BitField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span>
                      <span class="n">is_reply</span><span class="o">=</span><span class="n">BitBool</span><span class="p">(),</span>  <span class="c"># QR</span>
                      <span class="n">opcode</span><span class="o">=</span><span class="n">BitNum</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
                      <span class="n">truncated</span><span class="o">=</span><span class="n">BitBool</span><span class="p">(),</span>
                      <span class="n">recursion_desired</span><span class="o">=</span><span class="n">BitBool</span><span class="p">(),</span>
                      <span class="n">ra</span><span class="o">=</span><span class="n">BitBool</span><span class="p">(),</span>
                      <span class="n">z</span><span class="o">=</span><span class="n">BitBool</span><span class="p">(),</span>
                      <span class="n">non_authenticated_data_acceptable</span><span class="o">=</span><span class="n">BitBool</span><span class="p">(),</span>
                      <span class="n">cd</span><span class="o">=</span><span class="n">BitBool</span><span class="p">(),</span>
                      <span class="n">rcode</span><span class="o">=</span><span class="n">BitNum</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
                  <span class="p">)</span>
    <span class="n">total_questions</span> <span class="o">=</span> <span class="n">UBInt16</span><span class="p">()</span>
    <span class="n">total_answers_rrs</span> <span class="o">=</span> <span class="n">UBInt16</span><span class="p">()</span>
    <span class="n">total_authority_rrs</span> <span class="o">=</span> <span class="n">UBInt16</span><span class="p">()</span>
    <span class="n">total_additional_rrs</span> <span class="o">=</span> <span class="n">UBInt16</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Payload</span><span class="p">()</span>  <span class="c"># greedy</span>
</pre></div>
</div>
<p>Although there is a fair bit here, you can see that it is generally
easy to follow and about as simple as the table you can find on the
Wikipedia page describing the same message.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example is based on a quick review of the DNS message format
and may not be correct.  Please create a github issue if you
believe there is a problem with this example.</p>
</div>
</div>
<div class="section" id="using-the-model">
<h2>Using the Model<a class="headerlink" href="#using-the-model" title="Permalink to this headline">¶</a></h2>
<p>The structure above provides suitcase with a wealth of information
about the names, sizes, order, and relationship between different
elements in a <cite>DNSMessage</cite>.  That knowledge is enough so that suitcase
can now both pack (generate bytes from and object) and parse (generate
an object from bytes) for our message.</p>
<div class="section" id="parsing">
<h3>Parsing<a class="headerlink" href="#parsing" title="Permalink to this headline">¶</a></h3>
<p>For some input data, I opened up wireshark and then navigated to
<a class="reference external" href="https://docs.digi.com">docs.digi.com</a> in my web browser.  Looking
through wireshark, I can see the request and copy the hex for the DNS
portion of the message:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dns_request_hex</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&quot;28b30100000100000000000004646f63730464696769&quot;</span>
    <span class="s">&quot;03636f6d0000010001&quot;</span><span class="p">)</span>
<span class="n">dns_request_data</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">dns_request_hex</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">DNSMessage</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">dns_request_data</span><span class="p">))</span>
</pre></div>
</div>
<p>This generates the following based on the repr of the returned instance
of our structure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DNSMessage</span> <span class="p">(</span>
  <span class="n">identification</span><span class="o">=</span><span class="mi">10419</span><span class="p">,</span>
  <span class="n">fields</span><span class="o">=</span><span class="n">BitField</span><span class="p">(</span>
    <span class="n">is_reply</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">opcode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">truncated</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">recursion_desired</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">ra</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">z</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">non_authenticated_data_acceptable</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">cd</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">rcode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="p">),</span>
  <span class="n">total_questions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">total_answers_rrs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="n">total_authority_rrs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="n">total_additional_rrs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="n">data</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x04</span><span class="s">docs</span><span class="se">\x04</span><span class="s">digi</span><span class="se">\x03</span><span class="s">com</span><span class="se">\x00\x00\x01\x00\x01</span><span class="s">&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="packing">
<h3>Packing<a class="headerlink" href="#packing" title="Permalink to this headline">¶</a></h3>
<p>In the same way that a stream of bytes can be used to populate an instance of our
structure, we can also build up a <cite>DNSMessage</cite> and turn it into bytes.  This
is a little tedious since <cite>DNSMessage</cite> has quite a few fields, but it is
very easy to see what is going on.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="n">DNSMessage</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">identification</span> <span class="o">=</span> <span class="mh">0x1234</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">is_reply</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">opcode</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">truncated</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">recursion_desired</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">ra</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">non_authenticated_data_acceptable</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">cd</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">m</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">rcode</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m</span><span class="o">.</span><span class="n">total_questions</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">m</span><span class="o">.</span><span class="n">total_answers_rrs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m</span><span class="o">.</span><span class="n">total_authority_rrs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m</span><span class="o">.</span><span class="n">total_additional_rrs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s">&quot;docs.digi.com</span><span class="se">\x00\x00\x00\x00</span><span class="s">&quot;</span>

<span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span>
</pre></div>
</div>
<p>This generates a string like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&#39;</span><span class="se">\x12</span><span class="s">4</span><span class="se">\x02\x00\x00\x01\x00\x00\x00\x00\x00\x00</span><span class="s">docs.digi.com</span><span class="se">\x00\x00\x00\x00</span><span class="s">&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="working-with-streams">
<h2>Working With Streams<a class="headerlink" href="#working-with-streams" title="Permalink to this headline">¶</a></h2>
<p>In addition to being able to parse and pack messages, suitcase also includes
helpers that make working with stream-based protocols (e.g. TCP, Serial Port, etc).
much easier.  See the API documentation for more details.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">suitcase</a></h1>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-modeling">Data Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-model">Using the Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-streams">Working With Streams</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://www.digi.com/wireless-design-services/">Digi WDS</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/digidotcom/python-suitcase">Suitcase on Github</a></li>
    
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Digi International, Inc..
      
      |
      <a href="_sources/getting_started.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/digidotcom/python-suitcase" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>